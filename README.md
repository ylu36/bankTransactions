# Transaction Ontology

## Background
This project uses [Protege](https://protege.stanford.edu/products.php#desktop-protege), an Ontology editor, for GUI-based Ontology developement. Back-end RESTful APIs are developed with `sbt` using Play framework, a lightweight web framework built with Java and Scala. <br>

A payment processor (ex. PayPal) faces several monetary and legal risks. A transaction may be
fraudulent, or otherwise illegal, opening them up to legal action. A merchant might not ship a
product after accepting money, leading the consumer to demand their money back. And so on.
For this reason, risk assessment and management is a big part of payments business.
Risk assessment can often be very complex, with many statistical variables as well as hard laws
that must be complied with. For this reason, it is often implemented as a combination of a
machine learning and rule-based system.

## Project Specification
### Entities
#### Banks
- Can process multiple transactions
- Is either local or international
- Can be blacklisted, in which case it can no longer process transactions
#### Transaction request
This is a representation of a transaction before we have decided if it’s too risky to add to our
ontology.
- Is associated with a single bank
- Has a specific amount
- Has a sender and a receiver, identified by their IDs as added to the OWL ontology
- Has a single category: Medical, Dining, Gambling, Wages, Weapons, Other.
- Has a timestamp (generated by your system)
### Assessment rules
We will use our knowledge base about the banks and the incoming transaction request to
decide whether we should insert the transaction into our Ontology, or reject it. This should be
done according to the following rules:
1. A bank, once blacklisted, can no longer process any transactions
2. A transaction request belonging to the category of “Medical”, must go through,
regardless of what the following rules evaluate to (unless the bank is blacklisted)
3. A transaction request with category “Weapons” requires that (necessary, but not
sufficient conditions):
a. Both the sender and the receiver be trusted (note that only merchants can be
trusted, but you just need to check for membership in the class Trusted in your
ontology)
b. The bank must be local
4. A transaction request with amount >$100,000 must have at least one of the participants
Trusted.
5. A transaction request with amount >10 times the average amount for the given bank
should be rejected (except if it’s the bank’s first transaction).
6. If <25% of a bank’s past transaction involved a trusted participant, then the bank can no
longer process transactions that don’t involve a trusted participant (until the fraction goes
up to 25% again).
7. If a bank suffers 3 transaction rejections in a row, blacklist the bank.
If the transaction survives all the above rules, add it to the OWL ontology.

### Logging
Two log files are maintained, one for accepted transactions, and one for rejected ones.
The acceptance log has the following info per entry:
- Transaction ID
- Bank ID
- Sender ID
- Receiver ID
- Amount
- Category
- Timestamp

The rejection log has above info plus the rule it was rejected from. 

Both logs are accessible through the API as detailed.
## How to Run

### Play Framework
* Install latest version of sbt: [SBT](http://www.scala-sbt.org/download.html)
* Clone this repository: `git clone https://github.com/ylu36/transactionOntology.git`
* Go to `transactionOntology` folder: `cd transactionOntology`
* Type `sbt run` to run the application.
* For stopping the server, Press the `Enter` key on keyboard.
* For opening the sbt console, type `sbt` from the command prompt.
* There are following APIs present in the web application:

# RESTful APIs 
POST    /addconsumer/:id  
POST    /addmerchant/:id  
POST
/addbank/:nationality/:bankID    
POST
/transactionrequest/:senderID
/:receiverID/:bankID/:category
/:amount/:transactionRequest
ID   
GET     /iscommercial/:transactionID  
GET     /ispersonal/:transactionID                
GET     /ispurchase/:transactionID                            
GET     /isrefund/:transactionID                 
GET     /istrusted/:merchantID  
GET /isblacklisted/:bankID  
GET /bankrejections/:bankID   
POST    /reset  
GET /rejectionlog  
GET /acceptancelog  

**Note: This project is created in Linux environment; Endpoints tested with [Postman](https://www.getpostman.com/).
